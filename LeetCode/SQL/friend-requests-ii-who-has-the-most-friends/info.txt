{"id":1427539371,"question_id":602,"lang":"mysql","lang_name":"MySQL","time":"3 weeks, 6 days","timestamp":1729360899,"status":10,"status_display":"Accepted","runtime":"652 ms","url":"/submissions/detail/1427539371/","is_pending":"Not Pending","title":"Friend Requests II: Who Has the Most Friends","memory":"0B","code":"# Write your MySQL query statement below\n-- select count(total)  \n-- from(\n-- select accepter_id , count(accepter_id) as total From RequestAccepted \n-- group by accepter_id\n-- union \n-- select  requester_id , count(requester_id) From RequestAccepted \n-- group by  requester_id)\n-- group by total \n\n\nwith FriendRequests as (\n    SELECT accepter_id AS user_id, COUNT(accepter_id) AS total \n    FROM RequestAccepted \n    GROUP BY accepter_id\n    UNION ALL\n    SELECT requester_id AS user_id, COUNT(requester_id) AS total \n    FROM RequestAccepted \n    GROUP BY requester_id\n)\n\nselect user_id as id , sum(total) as num  From FriendRequests\ngroup by user_id \norder by num desc \nlimit 1\n\n \n\n","compare_result":"111111111111","title_slug":"friend-requests-ii-who-has-the-most-friends","has_notes":false,"flag_type":1}