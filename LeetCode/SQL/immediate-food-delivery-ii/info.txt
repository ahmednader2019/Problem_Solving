{"id":1427614966,"question_id":1292,"lang":"mysql","lang_name":"MySQL","time":"3 weeks, 5 days","timestamp":1729366223,"status":10,"status_display":"Accepted","runtime":"1201 ms","url":"/submissions/detail/1427614966/","is_pending":"Not Pending","title":"Immediate Food Delivery II","memory":"0B","code":"WITH part AS (\n    SELECT d1.customer_id, d1.order_date, d1.customer_pref_delivery_date\n    FROM Delivery d1\n    JOIN (\n        SELECT customer_id, MIN(order_date) AS min_order_date\n        FROM Delivery \n        GROUP BY customer_id\n    ) d2\n    ON d1.customer_id = d2.customer_id \n    AND d1.order_date = d2.min_order_date \n    AND d1.order_date = d1.customer_pref_delivery_date\n)\n\nSELECT ROUND(\n    (SELECT COUNT(*) FROM part) / \n    (\n        SELECT COUNT(*)\n        FROM Delivery d1\n        JOIN (\n            SELECT customer_id, MIN(order_date) AS min_order_date\n            FROM Delivery \n            GROUP BY customer_id\n        ) d2\n        ON d1.customer_id = d2.customer_id \n        AND d1.order_date = d2.min_order_date \n    ) *100, 2)  AS immediate_percentage;\n","compare_result":"11111111111111111111111","title_slug":"immediate-food-delivery-ii","has_notes":false,"flag_type":1}