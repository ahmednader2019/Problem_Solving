{"id":1439712181,"question_id":1480,"lang":"mysql","lang_name":"MySQL","time":"2Â weeks","timestamp":1730449847,"status":10,"status_display":"Accepted","runtime":"1528 ms","url":"/submissions/detail/1439712181/","is_pending":"Not Pending","title":"Movie Rating","memory":"0B","code":"with UserName as \n(\nSELECT mr.user_id, COUNT(mr.user_id) AS rating_count, u.name\nFROM MovieRating mr\nJOIN Users u ON mr.user_id = u.user_id\nGROUP BY mr.user_id\nHAVING COUNT(mr.user_id) = (\n    SELECT MAX(count) \n    FROM (\n        SELECT COUNT(user_id) AS count\n        FROM MovieRating\n        GROUP BY user_id\n    ) AS counts\n)\n)\n\n(select name  as results From UserName order by name asc limit 1)\nunion all\n(select m.title as results From MovieRating mr\njoin Movies m on mr.movie_id = m.movie_id\nWHERE mr.created_at BETWEEN '2020-02-01' AND '2020-02-29'\ngroup by mr.movie_id\norder by avg(mr.rating) desc , m.title asc\nlimit 1 )\n","compare_result":"1111111111111111111","title_slug":"movie-rating","has_notes":true,"flag_type":1}